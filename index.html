<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@chreeio/fastify-status</title>
	<meta name="description" content="Documentation for @chreeio/fastify-status">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@chreeio/fastify-status</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>@chreeio/fastify-status</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#fastify-status" id="fastify-status" style="color: inherit; text-decoration: none;">
					<h1>fastify-status</h1>
				</a>
				<p><a href="https://github.com/chreeio/fastify-status/actions?query=workflow%3A%22Build+Master%22"><img src="https://github.com/chreeio/fastify-status/workflows/Build%20Master/badge.svg" alt="Build Master status"></a>
					<a href="https://www.npmjs.com/package/@chreeio/fastify-status"><img src="https://img.shields.io/npm/v/@chreeio/fastify-status" alt="npm version"></a>
				<a href="LICENSE"><img src="https://img.shields.io/github/license/chreeio/fastify-status" alt="LICENCE"></a></p>
				<p><a href="https://www.fastify.io/">Fastify</a> plugin exposing overall server status: version, health and custom data.</p>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<pre><code><span class="hljs-built_in">npm</span> i @chreeio/fastify-status</code></pre>
				<a href="#features" id="features" style="color: inherit; text-decoration: none;">
					<h2>Features</h2>
				</a>
				<ul>
					<li>HTTP endpoint serving overall health, custom health checks, version and custom properties.<ul>
							<li>Can be turned off.</li>
							<li>Customizable path and <a href="https://www.fastify.io/docs/latest/Routes/#full-declaration">Fastify route options</a>.</li>
						</ul>
					</li>
					<li>Three-valued (<code>ok</code>, <code>degraded</code>, <code>failing</code>) overall health calculated from custom health checks.</li>
					<li>Health checks can execute scheduled or on-demand when service status is requested via HTTP.</li>
					<li>Customizable <a href="https://www.fastify.io/docs/latest/Hooks/#onrequest">Fastify onRequest hook</a> executed when the overall health is <code>failing</code>.</li>
				</ul>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<p>Simply import the plugin and register it:</p>
				<pre><code class="language-TypeScript"><span class="hljs-keyword">import</span> fastify <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;fastify&#x27;</span>
<span class="hljs-keyword">import</span> fastifyStatus <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@chreeio/fastify-status&#x27;</span>

<span class="hljs-keyword">const</span> app = fastify()

app.register(fastifyStatus, {
  route: {
    expose: <span class="hljs-literal">true</span>,
  },
})</code></pre>
				<p>Please take a look at the <a href="test">test</a> folder for more involved examples.</p>
				<a href="#options" id="options" style="color: inherit; text-decoration: none;">
					<h2>Options</h2>
				</a>
				<p>When registering <code>fastify-status</code>, you can set the following options. Please note, that each setting is optional.</p>
				<table>
					<thead>
						<tr>
							<th>Option</th>
							<th>Descripton</th>
						</tr>
					</thead>
					<tbody><tr>
							<td><strong>route.expose</strong></td>
							<td>Whether to expose an HTTP endpoint serving status information or not. Set to <code>false</code> by default.</td>
						</tr>
						<tr>
							<td><strong>route.path</strong></td>
							<td>The path of the HTTP status endpoint. Set to <code>/status</code> by default.</td>
						</tr>
						<tr>
							<td><strong>route.customOptions</strong></td>
							<td>Additional customization for the HTTP status endpoint. Please refer to <a href="https://www.fastify.io/docs/latest/Routes/#routes-option">https://www.fastify.io/docs/latest/Routes/#routes-option</a> regarding the permitted HTTP route options.</td>
						</tr>
						<tr>
							<td><strong>health.updateInterval</strong></td>
							<td>The interval between subsequent health checks in milliseconds. If not set, then health checks will be performed on each request to the exposed status endpoint. By default, this setting is not set.</td>
						</tr>
						<tr>
							<td><strong>health.checks</strong></td>
							<td>An arbitrary number of custom health checks. If an update interval is set, then these checks will be scheduled. Otherwise, they are executed on each request to the status endpoint.</td>
						</tr>
						<tr>
							<td><strong>health.overallStatusCalculator</strong></td>
							<td>A function calculating the overall health of the service using the values provided by the <code>checks</code>. By default, this function sets the overall health to <code>failing</code> if there&#39;s a <code>failing</code> check and <code>degraded</code> if there&#39;s a <code>degraded</code> check.</td>
						</tr>
						<tr>
							<td><strong>failingStatusRequestHook</strong></td>
							<td>A Fastify onRequest hook (<a href="https://www.fastify.io/docs/latest/Hooks/#onrequest">https://www.fastify.io/docs/latest/Hooks/#onrequest</a>) which is executed on each request if the current overall health of the service is <code>failing</code>. Note, that this hook is only registered if there&#39;s an update interval set for the health checks. By default, this hook will return <code>503 - Service Unavailable</code> to every request.</td>
						</tr>
						<tr>
							<td><strong>version</strong></td>
							<td>A string to string mapping of version information.</td>
						</tr>
						<tr>
							<td><strong>customProperties</strong></td>
							<td>Any additional custom properties. These are going to be appended to the response of the status endpoint.</td>
						</tr>
				</tbody></table>
				<a href="#acknowledgements" id="acknowledgements" style="color: inherit; text-decoration: none;">
					<h2>Acknowledgements</h2>
				</a>
				<p>This is an open source project maintained by <a href="https://chree.io">Chree</a>. For more projects maintained or supported by Chree, please head over to the <a href="https://opensource.chree.io">Chree Open Source page</a>.</p>
				<a href="#licence" id="licence" style="color: inherit; text-decoration: none;">
					<h2>Licence</h2>
				</a>
				<p>This package is licensed under <a href="LICENSE">MIT</a>.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_customproperty_.html">&quot;<wbr>Custom<wbr>Property&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_failingstatusrequesthook_.html">&quot;<wbr>Failing<wbr>Status<wbr>Request<wbr>Hook&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_fastifystatus_.html">&quot;<wbr>Fastify<wbr>Status&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_fastifystatusoptions_.html">&quot;<wbr>Fastify<wbr>Status<wbr>Options&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_healthcheckfunction_.html">&quot;<wbr>Healthcheck<wbr>Function&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_overallstatuscalculatorfunction_.html">&quot;<wbr>Overall<wbr>Status<wbr>Calculator<wbr>Function&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_status_.html">&quot;<wbr>Status&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_index_.html">&quot;index&quot;</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>